docName = R-Cam

all: pdf

pdf: clean
	@echo "Rerun outline" > $(docName).log
	@latex_count=1 ; \
	while egrep -s 'Rerun.*outline|Rerun.*bib|Rerun.*index' $(docName).log >/dev/null && [ $$latex_count -lt 17 ] ;\
	    do \
	      echo "Running latex: Pass $$latex_count..." ;\
	      pdflatex $(docName) > /dev/null;\
	      bibtex $(docName).aux > /dev/null;\
	      makeindex $(docName).idx > /dev/null 2>/dev/null;\
	      latex_count=`expr $$latex_count + 1` ;\
	    done
	@make clean > /dev/null

clean:
	@rm -f *.ps *.dvi *.aux *.toc *.idx *.ind *.ilg *.log *.out *.brf *.blg *.bbl Q.tex
